# Environment Variables Reference for Render Deployment

This file lists all environment variables needed for the Code Battle deployment on Render.

## Required Environment Variables (Prompted during setup)

### Database
```
MONGODB_URI=mongodb+srv://<username>:<password>@cluster.mongodb.net/codebattle?retryWrites=true&w=majority
```
- **Source**: MongoDB Atlas connection string
- **Required**: Yes
- **Security**: High - Contains database credentials

### Google OAuth
```
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
```
- **Source**: Google Cloud Console OAuth 2.0 credentials
- **Required**: Yes (for Google login)
- **Security**: High - OAuth credentials

### GitHub OAuth
```
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
```
- **Source**: GitHub Developer Settings OAuth App
- **Required**: Yes (for GitHub login)
- **Security**: High - OAuth credentials

## Auto-Generated Variables (Render generates these)

### Security Secrets
```
JWT_SECRET=<auto-generated-256-bit-secret>
SESSION_SECRET=<auto-generated-256-bit-secret>
```
- **Source**: Auto-generated by Render
- **Security**: High - Used for authentication

## Predefined Variables (Set in render.yaml)

### Application Configuration
```
NODE_ENV=production
PORT=10000
```

### Frontend Integration (Update after frontend deployment)
```
FRONTEND_URL=https://your-frontend-domain.onrender.com
CORS_ORIGIN=https://your-frontend-domain.onrender.com
```

### OAuth Redirect URIs (Update with actual backend domain)
```
GOOGLE_REDIRECT_URI=https://codebattle-backend.onrender.com/api/auth/google/callback
GITHUB_REDIRECT_URI=https://codebattle-backend.onrender.com/api/auth/github/callback
```

### LeetCode Service Configuration
```
LEETCODE_RATE_LIMIT_DELAY=2000
LEETCODE_API_BASE_URL=https://leetcode.com/api
```

### Security Configuration
```
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
BCRYPT_SALT_ROUNDS=12
```

## Setup Instructions

### 1. MongoDB Atlas
1. Create account at mongodb.com/atlas
2. Create new cluster (M0 free tier)
3. Create database user
4. Whitelist IPs (0.0.0.0/0 for all)
5. Get connection string from "Connect" button

### 2. Google OAuth Setup
1. Go to console.cloud.google.com
2. Create/select project
3. Enable Google+ API
4. Create OAuth 2.0 Client ID credentials
5. Add authorized redirect URI: `https://your-backend-domain.onrender.com/api/auth/google/callback`

### 3. GitHub OAuth Setup
1. Go to GitHub Settings → Developer settings → OAuth Apps
2. Create new OAuth App
3. Set authorization callback URL: `https://your-backend-domain.onrender.com/api/auth/github/callback`

## Post-Deployment Updates

After deploying, update these variables in Render Dashboard:

1. **FRONTEND_URL** - Set to your actual frontend URL
2. **CORS_ORIGIN** - Set to your actual frontend URL  
3. **GOOGLE_REDIRECT_URI** - Set to your actual backend URL
4. **GITHUB_REDIRECT_URI** - Set to your actual backend URL

Also update your OAuth applications with the correct redirect URIs.

## Security Notes

- Never commit secrets to version control
- Use Render's environment variable management
- Rotate secrets regularly
- Monitor access logs
- Use HTTPS only in production

## Validation

Run the validation script before deployment:
```bash
node validate-deployment.js
```

This checks that all required files and configurations are in place.
